{% load static %}
<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Shop || Pabna</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="shortcut icon" type="image/x-icon" href={% static 'img/favicon.ico' %}>
        <!-- Place favicon.ico in the root directory -->

		<!-- all css here -->
		<!-- bootstrap v3.3.6 css -->
        <link rel="stylesheet" href={% static 'css/bootstrap.min.css' %}>
		<!-- animate css -->
        <link rel="stylesheet" href={% static 'css/animate.css'%}>
		<!-- jquery-ui.min css -->
        <link rel="stylesheet" href={% static 'css/jquery-ui.min.css' %}>
		<!-- meanmenu css -->
        <link rel="stylesheet" href={% static 'css/meanmenu.min.css' %}>
		<!-- owl.carousel css -->
        <link rel="stylesheet" href={% static 'css/owl.carousel.css' %}>
		<!-- slick css -->
		<link rel="stylesheet" href={% static 'css/slick.css' %}>
		<!-- font-awesome css -->
        <link rel="stylesheet" href={% static 'css/font-awesome.min.css' %}>
		<!-- style css -->
		<link rel="stylesheet" href={% static 'css/style.css' %}>
		<!-- responsive css -->
        <link rel="stylesheet" href={% static 'css/responsive.css' %}>
		<!-- modernizr js -->
        <script src={% static 'js/vendor/modernizr-2.8.3.min.js' %}></script>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
		
		<!-- header start -->
        <header class="header-pos">
			<!-- header-bottom-area start -->
			<div class="header-bottom-area">
				<div class="container">
					<div class="inner-container">
						<div class="row">
							<div class="col-md-2 col-sm-4 col-xs-5">
								<div class="logo">
									<a href="index.html"><img src="img/logo-white-text.png" alt="" /></a>
								</div>
							</div>
							<div class="col-md-8 hidden-xs hidden-sm">
								<div class="main-menu">
									<nav>
										<ul>
											<li class="static"><a href={% url 'shop' %}>Catalogo</a>
											</li>
											<li><a href={% url 'shop' %}>Categorias</a>
												<div class="mega-menu mega-menu-2">
													<span>
														<a href="shop.html" class="mega-title">Ropa Para Mujer </a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
													</span>
													<span>
														<a href="shop.html" class="mega-title">Ropa Para Hombre </a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
													</span>
													<span class="mega-menu-img">
														<a href="shop.html"><img alt="" src="img/1.jpg"></a>
													</span>
												</div>
											</li>
											<li><a href={% url 'contact' %}>contactanos</a></li>
										</ul>
									</nav>
								</div>
							</div>
							<div class="col-md-2 col-sm-8 col-xs-7 header-right">
								<div class="my-cart">
									<div class="total-cart">
										<a href="{% url 'ver_carrito' %}">
											<i class="fa fa-shopping-cart"></i>
											<span id="cartItemCount">{{carro}}</span>
										</a>
									</div>
									<ul>
										{% for item in items %}
											<li class="cart-border">
												<div class="cart-img">
													<a href="{% url 'details' item.producto.id %}"><img alt="" src="{{ item.producto.imagen.url }}"></a>
												</div>
												<div class="cart-info">
													<h4><a href="{% url 'details' item.producto.id %}">{{ item.producto.nombre }}</a></h4>
													<h6><a class="decorar">Precio: $ {{item.producto.precio}} x {{item.cantidad}}</a></h6>
												</div>
											</li>
										{% endfor %}
										<a href="{% url 'ver_carrito' %}">
											<li class="cart-button">
												Ver Carro
											</li>
										</a>
									</ul>
								</div>
								<div class="user-meta">
									<a href="#"><i class="fa fa-cog"></i></a>
									<ul>
										<li><a href="#">Mi Cuenta</a></li>
										<li><a href="{% url 'deseos' %}">Lista De Deseos</a></li>
										<li><a href="{% url 'login' %}">Iniciar Sesion / Registro</a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- header-bottom-area end -->
			<!-- mobile-menu-area start -->
			<div class="mobile-menu-area visible-xs visible-sm">
				<div class="container">
					<div class="row">
						<div class="col-md-12">
							<div class="mobile-menu">
								<nav id="dropdown">
									<ul>
										<li><a href="shop.html">Ropa</a>
											<ul>
												<li><a href="#">WOMEN CLOTH</a>
													<ul>
														<li><a href="shop.html">casual shirt</a></li>
														<li><a href="shop.html">rikke t-shirt</a></li>
														<li><a href="shop.html">mia top </a></li>
														<li><a href="shop.html">muscle tee</a></li>
													</ul>
												</li>
												<li><a href="#">MEN CLOTH</a>
													<ul>
														<li><a href="shop.html">casual shirt</a></li>
														<li><a href="shop.html">rikke t-shirt</a></li>
														<li><a href="shop.html">mia top </a></li>
														<li><a href="shop.html">muscle tee</a></li>
													</ul>
												</li>
												<li><a href="#">WOMEN JEWELRY</a>
													<ul>
														<li><a href="shop.html">necklace </a></li>
														<li><a href="shop.html">chunky short striped</a></li>
														<li><a href="shop.html">samhar cuff </a></li>
														<li><a href="shop.html">nail set</a></li>
													</ul>
												</li>											
											</ul>
										</li>
										<li><a href="contact.html">Contactanos</a></li>
									</ul>
								</nav>
							</div>					
						</div>
					</div>
				</div>
			</div>
			<!-- mobile-menu-area end -->				
		</header>
		<!-- header end -->
		<!-- breadcrumb-area start -->
		<div class="breadcrumb-area">
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<div class="breadcrumb-list">
							<h1>CATALOGO</h1>
							<ul>
								<li><a href={% url 'index' %}>Inicio</a> <span class="divider">|</span></li>
								<li><a href={% url 'shop' %}>Categorias</a> <span class="divider">|</span></li>
								<li><a href="{% url 'ver_carrito' %}">Terminar Compra</a></li>
							</ul>							
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- breadcrumb-area end -->
		<!-- shop-area start -->
		<div class="shop-area">
			<div class="container">
				<div class="row">
					<!-- left-sidebar start -->
					<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
						<!-- widget-categories start -->
						<aside class="widget widget-categories">
							<h3 class="sidebar-title">Categories</h3>
							<ul class="sidebar-menu">
								<li><a href="#">Clothes</a> <span class="count">(14)</span></li>
								<li><a href="#">Men</a> <span class="count">(9)</span></li>
								<li><a href="#">Shoes</a> <span class="count">(2)</span></li>
								<li><a href="#">Sunglasses</a> <span class="count">(2)</span></li>
								<li><a href="#">Women</a> <span class="count">(8)</span></li>
							</ul>
						</aside>
						<!-- widget-categories end -->
						<!-- shop-filter start -->
						<aside class="widget shop-filter">
							<h3 class="sidebar-title">Filter selection</h3>
							<div class="info_widget">
								<div class="price_filter">
									<div id="slider-range"></div>
									<div class="price_slider_amount">
										<input type="text" id="amount" name="price"  placeholder="Add Your Price" />
										<input type="submit"  value="Filter"/>  
									</div>
								</div>
							</div>							
						</aside>
						<!-- shop-filter end -->
						<!-- filter-by start -->
						<aside class="widget filter-by">
							<h3 class="sidebar-title">Product price</h3>
							<ul class="sidebar-menu">
								<li><a href="#">L</a> <span class="count">(1)</span></li>
								<li><a href="#">M</a> <span class="count">(1)</span></li>
								<li><a href="#">S</a> <span class="count">(1)</span></li>
								<li><a href="#">XL</a> <span class="count">(1)</span></li>
								<li><a href="#">XXL</a> <span class="count">(1)</span></li>
							</ul>						
						</aside>
						<!-- filter-by end -->
						<!-- widget start -->
						<aside class="widget filter-by">
							<h3 class="sidebar-title">Color</h3>
							<ul class="sidebar-menu">
								<li><a href="#">Black</a> <span class="count">(1)</span></li>
								<li><a href="#">White</a> <span class="count">(8)</span></li>
								<li><a href="#">Orange</a> <span class="count">(5)</span></li>
								<li><a href="#">Blue</a> <span class="count">(7)</span></li>
								<li><a href="#">Yellow</a> <span class="count">(11)</span></li>
								<li><a href="#">Brown</a> <span class="count">(16)</span></li>
								<li><a href="#">red</a> <span class="count">(9)</span></li>
							</ul>						
						</aside>
						<!-- widget end -->
										
						
										
					</div>
					<!-- left-sidebar end -->
					<div class="col-md-9 col-sm-12 col-xs-12">
						<div class="shop-content">					
							<!-- Nav tabs -->
									
							<div class="shop-breadcrumb">
								<ul>
									<li class="active"><a href="#">1</a></li>
									<li><a href="#">2</a></li>
									<li><a href="#">3</a></li>
									<li><a href="#"><i class="fa fa-angle-right"></i></a></li>
								</ul>
							</div>

							<div class="clear"></div>
							<!-- Tab panes -->
							<div class="tab-content">
								<div role="tabpanel" class="tab-pane active" id="home">
									<div class="row">
										<!-- single-product start -->
										{% for p in productos %}
											{% if p.stock == 'si' %}
										<div class="col-md-4 col-sm-4">
											<div class="single-product">
												<div class="product-img">
													<a href="{% url 'details' p.id %}">
													{% if p.imagen %}
														<img src={{ p.imagen.url }} width="480px" height="606px"/>
													{% else %}
														<h1>No Photo</h1>
													{% endif %}
													</a>
													<div class="product-action">
														<div class="button-top">
															<a href="#" data-toggle="modal" data-target="#productModal"><i class="fa fa-search"></i></a>
															<a href="{% url 'agregar_a_deseos' p.id %}" ><i class="fa fa-heart"></i></a>
														</div>
														<div class="button-cart">
															<a href="" onclick="addToCart(event, {{ p.id }})">
														<button class="button-cart"  id="addedToCart" >
															<i class="fa fa-shopping-cart"></i> Añadir Al Carrito 
														</button>
															</a>
													</div>
													</div>
												</div>
												<div class="product-content">
													<h3><a href="{% url 'details' p.id %}">{{ p.nombre }}</a></h3>
													<div class="price">
														<span>Precio: {{p.precio}}</span>
														{% comment %} <span class="old">$90.11</span> {% endcomment %}
													</div>
												</div>
											</div>
										</div>
											{% endif %}
										{% endfor %}
										<!-- single-product end -->								
									</div>
								</div>

								<div class="cart-container hidden" id="cartContainer">
									<div class="icon-container">
										<div class="cart-icon icon-image"><img src="{% static 'img/carrito-de-supermercado.png' %}" width="80px" height="80px"></div>
										<div class="check-icon hidden icon-image"><img  class="imagen" src="{% static 'img/prueba.png' %}" width="80px" height="80px"></div>
									</div>
									<br><br>
								</div>
								
								<script>
									const cartContainer = document.getElementById('cartContainer');
									const iconContainer = document.querySelector('.icon-container');
								
									function addToCart(event, productId) {
										event.preventDefault();
								
										// Muestra el contenedor de iconos
										cartContainer.classList.remove('hidden');
								
										// Cambia la imagen del carrito a la de verificación después de un breve retraso
										setTimeout(() => {
											iconContainer.querySelector('.cart-icon').classList.add('hidden');
											iconContainer.querySelector('.check-icon').classList.remove('hidden');
								
											// Agrega la clase 'added' después de otro breve retraso
											setTimeout(() => {
												// Oculta el contenedor de iconos y restaura la imagen del carrito
												cartContainer.classList.add('hidden');
												iconContainer.querySelector('.cart-icon').classList.remove('hidden');
												iconContainer.querySelector('.check-icon').classList.add('hidden');
								
												// Hacer la solicitud AJAX a la vista de Django para agregar al carrito
												const url = `/agregar_al_carrito/${productId}/`;

												console.log('URL de solicitud:', url);  // Agrega este mensaje de depuración

												fetch(url, {
													method: 'GET',
													headers: {
														'Content-Type': 'application/json',
													},
												})
												.then(response => {
													if (!response.ok) {
														throw new Error(`Error: ${response.status}`);
													}
													return response.json();
												})
												.then(data => {
													console.log('Producto agregado al carrito:', data);
													// Resto del código si es necesario
													
												})
												.catch(error => {
													console.error('Error al agregar al carrito:', error);
													// Manejar el error si es necesario
												});
											}, 800); // Ajusta el tiempo según tu preferencia
										}, 1000);
										// Espera 3 segundos antes de recargar la página
										setTimeout(() => {
											window.location.reload();
										}, 5000);
									}
									
								</script>
								
								<style>
									.imagen{
										border-radius: 50px;
									}
									.hidden {
										display: none;
									}
								
									.cart-container {
										display: flex;
										justify-content: flex-end;
										align-items: flex-start;
										position: fixed;
										top: 10px;
										right: 10px;
										z-index: 100;
										transition: opacity 0.5s;
										opacity: 1;
									}
								
									.icon-container {
										display: flex;
										transition: .8s ease-in-out;
									}
								
									.icon-image {
										position: relative;
										font-size: 40px;
										background-color: white;
										border-radius: 50px;
										padding: 10px;
										display: flex;
										justify-content: center;
										align-items: center;
										transition: .8s ease-in-out;
									}
								
									.check-icon.hidden img {
										opacity: 0;
										transform: scale(0.1);
										border-radius: 40px;
									}
								</style>
								
								<!--view as-->
								
		
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- shop-area end -->
		
		<!-- footer start -->
		<footer>
			<div class="footer-top">
				<div class="container">
					<div class="row">
						<div class="col-md-12">
							<div class="footer-logo">
								<img src={% static 'img/logo-white-text.png' %} alt="" /><br>
								🫣 Encuentra tu estilo, siéntete imparable y conquista el mundo con cada atuendo. ¡Tu ropa, tu historia, tu poder! ✌️
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- footer-top-area start -->
			<div class="footer-top-area">
				<div class="container">
					<div class="row">
						<!-- footer-widget start -->
						<div class="col-lg-3 col-md-3 col-sm-4">
							<div class="footer-widget">
								<h3>CONTACT US</h3>
								<ul class="footer-contact">
									<li>
										<i class="fa fa-envelope"> </i>
										Email: admin@BasicTheme.com
									</li>
									<li>
										<i class="fa fa-phone"> </i>
										Phone: +123 455657589
									</li>
								</ul>
							</div>
						</div>
						<!-- footer-widget end -->
						
					</div>
				</div>
			</div>
			<!-- footer-top-area end -->
			<!-- footer-bottom-area start -->
			<div class="footer-bottom-area">
				<div class="container">
					<div class="row">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<div class="copyright">
								<p>Copyright © <a href="#">Pabna</a>. All Rights Reserved</p>
								<div class="payment-img">
									<img src={% static 'img/paypal.png' %} width="40px" height="40px">
									<img src={% static 'img/tarjeta.png' %} width="40px" height="40px">
									<img src={% static 'img/nequi.svg' %} width="40px" height="40px">
								</div>
							</div>
							
						</div>
						
					</div>
				</div>
			</div>
			<!-- footer-bottom-area end -->
		</footer>
		<!-- footer end -->
		
		<!-- QUICKVIEW PRODUCT -->
		<div id="quickview-wrapper">
			<!-- Modal -->
			<div class="modal fade" id="productModal" tabindex="-1" role="dialog">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						</div>
						<div class="modal-body">
							<div class="modal-product">
								<div class="product-images">
									<div class="main-image images">
									<a>
										<img alt="" src={% static 'img/product/13.jpg' %}>
									</a>
									</div>
								</div><!-- .product-images -->
								
								<div class="product-info">
									<h1>Diam quis cursus</h1>
									<div class="price-box">
										<p class="price"><span class="special-price"><span class="amount">$132.00</span></span></p>
									</div>
									<div class="quick-add-to-cart">
										<form method="post" class="cart">
											<div class="numbers-row">
												<input type="number" id="french-hens" value="3">
											</div>
											<button class="single_add_to_cart_button" type="submit">Add to cart</button>
										</form>
									</div>
									<div class="quick-desc">
										Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam fringilla augue nec est tristique auctor. Donec non est at libero vulputate rutrum. Morbi ornare lectus quis justo gravida semper. Nulla tellus mi, vulputate adipiscing cursus eu, suscipit id nulla.
									</div>
									<div class="social-sharing">
										<div class="widget widget_socialsharing_widget">
											
										</div>
									</div>
								</div><!-- .product-info -->
							</div><!-- .modal-product -->
						</div><!-- .modal-body -->
					</div><!-- .modal-content -->
				</div><!-- .modal-dialog -->
			</div>
			<!-- END Modal -->
		</div>
		<!-- END QUICKVIEW PRODUCT -->	


		<!-- all js here -->
		<!-- jquery latest version -->
        <script src={% static 'js/vendor/jquery-1.12.0.min.js' %}></script>
		<!-- bootstrap js -->
        <script src={% static 'js/bootstrap.min.js' %}></script>
		<!-- owl.carousel js -->
        <script src={% static 'js/owl.carousel.min.js' %}></script>
		<!-- meanmenu js -->
        <script src={% static 'js/jquery.meanmenu.js' %}></script>
		<!-- jquery-ui js -->
        <script src={% static 'js/jquery-ui.min.js' %}></script>
		<!-- wow js -->
        <script src={% static 'js/wow.min.js' %}></script>
		<!-- plugins js -->
        <script src={% static 'js/plugins.js' %}></script>
		<!-- main js -->
        <script src={% static 'js/main.js' %}></script>
    </body>
</html>
